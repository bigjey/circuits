(this.webpackJsonpcircuits=this.webpackJsonpcircuits||[]).push([[0],{15:function(t,n,i){},16:function(t,n,i){},18:function(t,n,i){"use strict";i.r(n);var e=i(3),s=i.n(e),a=i(10),c=i.n(a),u=(i(15),i(6)),o=i(9),r=i(1),l=i(2),d=i(4),p=i(5),h=(i(16),i(0)),v=function(){function t(n,i,e){Object(d.a)(this,t),this.position={x:0,y:0},this.state=0,this.id=n,this.position.x=i,this.position.y=e}return Object(p.a)(t,[{key:"value",get:function(){return this.state}},{key:"toggle",value:function(){0===this.state?this.state=1:this.state=0}}]),t}(),f=function(){function t(n,i,e){Object(d.a)(this,t),this.position={x:0,y:0},this.state=0,this.id=n,this.position.x=i,this.position.y=e}return Object(p.a)(t,[{key:"value",get:function(){return this.state}}]),t}(),j=function(){function t(n,i,e){Object(d.a)(this,t),this.name="NOT",this.type="not",this.position={x:0,y:0},this.inputs=[],this.outputs=[],this.id=n,this.position.x=i,this.position.y=e,this.inputs.push(new v("".concat(this.id,":i1"))),this.outputs.push(new f("".concat(this.id,":o1"))),this.evaluate()}return Object(p.a)(t,[{key:"evaluate",value:function(){1===this.inputs[0].value?this.outputs[0].state=0:this.outputs[0].state=1}}]),t}(),O=function(){function t(n,i,e){Object(d.a)(this,t),this.name="AND",this.type="and",this.position={x:0,y:0},this.inputs=[],this.outputs=[],this.id=n,this.position.x=i,this.position.y=e,this.inputs.push(new v("".concat(this.id,":i1"))),this.inputs.push(new v("".concat(this.id,":i2"))),this.outputs.push(new f("".concat(this.id,":o1"))),this.evaluate()}return Object(p.a)(t,[{key:"evaluate",value:function(){1===this.inputs[0].value&&1===this.inputs[1].value?this.outputs[0].state=1:this.outputs[0].state=0}}]),t}(),y=function(t){var n=t.input,i=(t.connections,Object(o.a)(t,["input","connections"]));return Object(h.jsx)("div",Object(u.a)(Object(u.a)({id:n.id},i),{},{className:"circuit-input ".concat(1===n.value?"circuit-input-on":""),style:{left:n.position.x,top:n.position.y}}))},b=function(t){var n=t.output,i=(t.connections,Object(o.a)(t,["output","connections"]));return Object(h.jsx)("div",Object(u.a)(Object(u.a)({id:n.id},i),{},{className:"circuit-output ".concat(1===n.value?"circuit-output-on":""),style:{right:n.position.x,top:n.position.y}}))},g=function(t){var n=t.gate,i=(t.connections,t.onConnectionMade);return Object(h.jsxs)("div",{id:n.id,className:"circuit-gate circuit-gate-".concat(n.type),style:{left:n.position.x,top:n.position.y},onMouseDown:function(t){w||(w={gateId:n.id,startMousePos:{x:t.clientX,y:t.clientY},startGatePos:{x:n.position.x,y:n.position.y}})},children:[Object(h.jsx)("div",{className:"circuit-gate-inputs",children:n.inputs.map((function(t){return Object(h.jsx)("div",{id:t.id,className:"circuit-gate-input ".concat(1===t.value?"circuit-gate-input-on":""),onMouseUp:function(){k&&i(k,t.id),k=null}},t.id)}))}),Object(h.jsx)("div",{className:"circuit-gate-name",children:n.name}),Object(h.jsx)("div",{className:"circuit-gate-outputs",children:n.outputs.map((function(t){return Object(h.jsx)("div",{id:t.id,className:"circuit-gate-output ".concat(1===t.value?"circuit-gate-output-on":""),onMouseDown:function(n){k||(k=t.id,n.stopPropagation())}},t.id)}))})]})},m=function(t){var n,i,e,s,a=t.start,c=t.end,u=t.complete,o=void 0!==u&&u,r=document.getElementById(a),l=document.getElementById(c);if(o){if(!r||!l)return null;var d=r.getBoundingClientRect(),p=l.getBoundingClientRect();n=d.x+d.width/2,i=d.y+d.height/2,e=p.x+p.width/2,s=p.y+p.height/2}else{if(!r)return null;var v=r.getBoundingClientRect();n=v.x+v.width/2,i=v.y+v.height/2,e=I.x,s=I.y}return Object(h.jsx)("line",{x1:n,y1:i,x2:e,y2:s})},x=new(function(){function t(){Object(d.a)(this,t),this._gateId=1,this._inputId=1,this._outputId=1,this.inputs={},this.outputs={},this.gates={},this.connections=new Set}return Object(p.a)(t,[{key:"addInput",value:function(t){var n=new v("c:i".concat(this._inputId++),0,t);this.inputs[n.id]=n}},{key:"addOutput",value:function(t){var n=new f("c:o".concat(this._outputId++),0,t);this.outputs[n.id]=n}},{key:"addGate",value:function(t,n,i){var e=new t("g".concat(this._gateId++),n,i);this.gates[e.id]=e}},{key:"addConnection",value:function(t,n){this.connections.add("".concat(t,"-").concat(n));var i=n.split(":"),e=Object(l.a)(i,1)[0];"c"===e?this.updateOutput(n):this.gates[e]?this.updateGate(e):console.error("unknown destination",n)}},{key:"removeInput",value:function(t){delete this.inputs[t];for(var n=new Set,i=0,e=Array.from(this.connections);i<e.length;i++){var s=e[i],a=s.split("-"),c=Object(l.a)(a,2),u=c[0],o=c[1];if(u===t){this.connections.delete(s);var d=o.split(":"),p=Object(l.a)(d,1)[0];"c"===p?n.add(o):n.add(p)}}var h,v=Object(r.a)(n);try{for(v.s();!(h=v.n()).done;){var f=h.value;"c"===f[0]?this.updateOutput(f):this.updateGate(f)}}catch(j){v.e(j)}finally{v.f()}}},{key:"removeOutput",value:function(t){delete this.outputs[t];var n,i=Object(r.a)(this.allIncomingSignals(t));try{for(i.s();!(n=i.n()).done;){var e=n.value;this.connections.delete("".concat(e,"-").concat(t))}}catch(s){i.e(s)}finally{i.f()}}},{key:"getSourceValue",value:function(t){var n=t.split(":"),i=Object(l.a)(n,1)[0];return"c"===i?this.inputs[t].value:this.gates[i].outputs.find((function(n){return n.id===t})).value}},{key:"allIncomingSignals",value:function(t){var n,i=[],e=Object(r.a)(this.connections.values());try{for(e.s();!(n=e.n()).done;){var s=n.value.split("-"),a=Object(l.a)(s,2),c=a[0];a[1]===t&&i.push(c)}}catch(u){e.e(u)}finally{e.f()}return i}},{key:"allOutcomingSignals",value:function(t){var n,i=[],e=Object(r.a)(this.connections.values());try{for(e.s();!(n=e.n()).done;){var s=n.value.split("-"),a=Object(l.a)(s,2),c=a[0],u=a[1];c===t&&i.push(u)}}catch(o){e.e(o)}finally{e.f()}return i}},{key:"updateGate",value:function(t){var n,i=this.gates[t],e=Object(r.a)(i.inputs);try{for(e.s();!(n=e.n()).done;){var s=n.value;s.state=0;var a,c=Object(r.a)(this.allIncomingSignals(s.id));try{for(c.s();!(a=c.n()).done;){var u=a.value;if(1===this.getSourceValue(u)){s.state=1;break}}}catch(y){c.e(y)}finally{c.f()}}}catch(y){e.e(y)}finally{e.f()}i.evaluate();var o,d=Object(r.a)(i.outputs);try{for(d.s();!(o=d.n()).done;){var p,h=o.value,v=Object(r.a)(this.allOutcomingSignals(h.id));try{for(v.s();!(p=v.n()).done;){var f=p.value,j=f.split(":"),O=Object(l.a)(j,1)[0];"c"===O?this.updateOutput(f):this.updateGate(O)}}catch(y){v.e(y)}finally{v.f()}}}catch(y){d.e(y)}finally{d.f()}}},{key:"updateOutput",value:function(t){var n,i=Object(r.a)(x.allIncomingSignals(t));try{for(i.s();!(n=i.n()).done;){var e=n.value;if(1===this.getSourceValue(e))return void(this.outputs[t].state=1)}}catch(s){i.e(s)}finally{i.f()}this.outputs[t].state=0}}]),t}());x.addGate(O,100,100),x.addGate(j,300,100);var k=null,w=null,I={x:0,y:0},N=[{classPointer:O,name:"AND"},{classPointer:j,name:"NOT"}];var M=function(){var t=s.a.useState(),n=Object(l.a)(t,2)[1],i=s.a.useCallback((function(){return n({})}),[]),e=function(t,n){x.addConnection(t,n),i()};return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsxs)("div",{className:"circuit",onMouseUp:function(){k=null,w=null,i()},onMouseMove:function(t){if(k&&(I.x=t.clientX,I.y=t.clientY,i()),w){var n=t.clientX-w.startMousePos.x,e=t.clientY-w.startMousePos.y,s=w.startGatePos.x+n,a=w.startGatePos.y+e;x.gates[w.gateId].position.x=s,x.gates[w.gateId].position.y=a,i()}},children:[Object(h.jsx)("div",{className:"circuit-inputs",onClick:function(t){x.addInput(t.clientY-20),i()}}),Object(h.jsx)("div",{className:"circuit-outputs",onClick:function(t){x.addOutput(t.clientY-20),i()}}),Object.values(x.inputs).map((function(t){return Object(h.jsx)(y,{input:t,connections:x.connections,onClick:function(n){if(n.ctrlKey)x.removeInput(t.id);else{t.toggle();var e,s=Object(r.a)(x.allOutcomingSignals(t.id));try{for(s.s();!(e=s.n()).done;){var a=e.value,c=a.split(":"),u=Object(l.a)(c,1)[0];x.gates[u]?x.updateGate(u):"c"===u&&x.updateOutput(a)}}catch(o){s.e(o)}finally{s.f()}}i()},onMouseDown:function(){k||(k=t.id)}},t.id)})),Object.values(x.outputs).map((function(t){return Object(h.jsx)(b,{output:t,connections:x.connections,onClick:function(n){n.ctrlKey&&x.removeOutput(t.id),i()},onMouseUp:function(){k&&e(k,t.id),k=null}},t.id)})),Object.values(x.gates).map((function(t){return Object(h.jsx)(g,{gate:t,connections:x.connections,onConnectionMade:e},t.id)})),Object(h.jsxs)("svg",{children:[Array.from(x.connections).map((function(t){var n=t.split("-"),i=Object(l.a)(n,2),e=i[0],s=i[1];return Object(h.jsx)(m,{complete:!0,start:e,end:s},t)})),k&&Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(m,{start:k})})]})]}),N.map((function(t){return Object(h.jsx)("div",{onClick:function(){x.addGate(t.classPointer,300,300),i()},children:t.name})}))]})};c.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(M,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.56926631.chunk.js.map