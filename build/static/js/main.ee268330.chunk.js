(this.webpackJsonpcircuits=this.webpackJsonpcircuits||[]).push([[0],{15:function(t,n,i){},16:function(t,n,i){},18:function(t,n,i){"use strict";i.r(n);var e=i(3),u=i.n(e),s=i(10),c=i.n(s),a=(i(15),i(6)),o=i(9),r=i(2),l=i(1),p=i(4),d=i(5),h=(i(16),i(0)),v=function(){function t(n,i,e){Object(p.a)(this,t),this.position={x:0,y:0},this.state=0,this.id=n,this.position.x=i,this.position.y=e}return Object(d.a)(t,[{key:"value",get:function(){return this.state}},{key:"toggle",value:function(){0===this.state?this.state=1:this.state=0}}]),t}(),f=function(){function t(n,i,e){Object(p.a)(this,t),this.position={x:0,y:0},this.state=0,this.id=n,this.position.x=i,this.position.y=e}return Object(d.a)(t,[{key:"value",get:function(){return this.state}}]),t}(),j=function(){function t(n,i,e){Object(p.a)(this,t),this.name="NOT",this.type="not",this.position={x:0,y:0},this.inputs=[],this.outputs=[],this.id=n,this.position.x=i,this.position.y=e,this.inputs.push(new v("".concat(this.id,":i1"))),this.outputs.push(new f("".concat(this.id,":o1"))),this.evaluate()}return Object(d.a)(t,[{key:"evaluate",value:function(){1===this.inputs[0].value?this.outputs[0].state=0:this.outputs[0].state=1}}]),t}(),O=function(){function t(n,i,e){Object(p.a)(this,t),this.name="AND",this.type="and",this.position={x:0,y:0},this.inputs=[],this.outputs=[],this.id=n,this.position.x=i,this.position.y=e,this.inputs.push(new v("".concat(this.id,":i1"))),this.inputs.push(new v("".concat(this.id,":i2"))),this.outputs.push(new f("".concat(this.id,":o1"))),this.evaluate()}return Object(d.a)(t,[{key:"evaluate",value:function(){1===this.inputs[0].value&&1===this.inputs[1].value?this.outputs[0].state=1:this.outputs[0].state=0}}]),t}(),b=function(t){var n=t.input,i=(t.connections,Object(o.a)(t,["input","connections"]));return Object(h.jsx)("div",Object(a.a)(Object(a.a)({id:n.id},i),{},{className:"circuit-input ".concat(1===n.value?"circuit-input-on":""),style:{left:n.position.x,top:n.position.y}}))},y=function(t){var n=t.output,i=(t.connections,Object(o.a)(t,["output","connections"]));return Object(h.jsx)("div",Object(a.a)(Object(a.a)({id:n.id},i),{},{className:"circuit-output ".concat(1===n.value?"circuit-output-on":""),style:{right:n.position.x,top:n.position.y}}))},g=function(t){var n=t.gate,i=(t.connections,t.onConnectionMade);return Object(h.jsxs)("div",{id:n.id,className:"circuit-gate circuit-gate-".concat(n.type),style:{left:n.position.x,top:n.position.y},children:[Object(h.jsx)("div",{className:"circuit-gate-inputs",children:n.inputs.map((function(t){return Object(h.jsx)("div",{id:t.id,className:"circuit-gate-input ".concat(1===t.value?"circuit-gate-input-on":""),onMouseUp:function(){k&&i(k,t.id),k=null}},t.id)}))}),Object(h.jsx)("div",{className:"circuit-gate-name",children:n.name}),Object(h.jsx)("div",{className:"circuit-gate-outputs",children:n.outputs.map((function(t){return Object(h.jsx)("div",{id:t.id,className:"circuit-gate-output ".concat(1===t.value?"circuit-gate-output-on":""),onMouseDown:function(){k||(k=t.id)}},t.id)}))})]})},m=function(t){var n,i,e,u,s=t.start,c=t.end,a=t.complete,o=void 0!==a&&a,r=document.getElementById(s),l=document.getElementById(c);if(o){if(!r||!l)return null;var p=r.getBoundingClientRect(),d=l.getBoundingClientRect();n=p.x+p.width/2,i=p.y+p.height/2,e=d.x+d.width/2,u=d.y+d.height/2}else{if(!r)return null;var v=r.getBoundingClientRect();n=v.x+v.width/2,i=v.y+v.height/2,e=w.x,u=w.y}return Object(h.jsx)("line",{x1:n,y1:i,x2:e,y2:u})},x=new(function(){function t(){Object(p.a)(this,t),this._gateId=1,this._inputId=1,this._outputId=1,this.inputs={},this.outputs={},this.gates={},this.connections=new Set}return Object(d.a)(t,[{key:"addInput",value:function(t){var n=new v("c:i".concat(this._inputId++),0,t);this.inputs[n.id]=n}},{key:"addOutput",value:function(t){var n=new f("c:o".concat(this._outputId++),0,t);this.outputs[n.id]=n}},{key:"addGate",value:function(t,n,i){var e=new t("g".concat(this._gateId++),n,i);this.gates[e.id]=e}},{key:"addConnection",value:function(t,n){this.connections.add("".concat(t,"-").concat(n));var i=n.split(":"),e=Object(l.a)(i,1)[0];"c"===e?this.updateOutput(n):this.gates[e]?this.updateGate(e):console.error("unknown destination",n)}},{key:"removeInput",value:function(t){delete this.inputs[t]}},{key:"removeOutput",value:function(t){delete this.outputs[t]}},{key:"getSourceValue",value:function(t){var n=t.split(":"),i=Object(l.a)(n,1)[0];return"c"===i?this.inputs[t].value:this.gates[i].outputs.find((function(n){return n.id===t})).value}},{key:"allIncomingSignals",value:function(t){var n,i=[],e=Object(r.a)(this.connections.values());try{for(e.s();!(n=e.n()).done;){var u=n.value.split("-"),s=Object(l.a)(u,2),c=s[0];s[1]===t&&i.push(c)}}catch(a){e.e(a)}finally{e.f()}return i}},{key:"allOutcomingSignals",value:function(t){var n,i=[],e=Object(r.a)(this.connections.values());try{for(e.s();!(n=e.n()).done;){var u=n.value.split("-"),s=Object(l.a)(u,2),c=s[0],a=s[1];c===t&&i.push(a)}}catch(o){e.e(o)}finally{e.f()}return i}},{key:"updateGate",value:function(t){var n,i=this,e=this.gates[t],u=Object(r.a)(e.inputs);try{for(u.s();!(n=u.n()).done;){var s=n.value;s.state=0;var c,a=Object(r.a)(this.allIncomingSignals(s.id));try{var o=function(){var t=c.value;console.log({signal:t});var n=t.split(":"),e=Object(l.a)(n,1)[0];if(1===("c"===e?i.inputs[t].value:i.gates[e].outputs.find((function(n){return n.id===t})).value))return s.state=1,"break"};for(a.s();!(c=a.n()).done;){if("break"===o())break}}catch(y){a.e(y)}finally{a.f()}}}catch(y){u.e(y)}finally{u.f()}e.evaluate();var p,d=Object(r.a)(e.outputs);try{for(d.s();!(p=d.n()).done;){var h=p.value;console.log({gateOutput:h});var v,f=Object(r.a)(this.allOutcomingSignals(h.id));try{for(f.s();!(v=f.n()).done;){var j=v.value;console.log({signal:j});var O=j.split(":"),b=Object(l.a)(O,1)[0];"c"===b?this.updateOutput(j):this.updateGate(b)}}catch(y){f.e(y)}finally{f.f()}}}catch(y){d.e(y)}finally{d.f()}}},{key:"updateOutput",value:function(t){var n,i=this,e=Object(r.a)(x.allIncomingSignals(t));try{var u=function(){var e=n.value,u=e.split(":"),s=Object(l.a)(u,1)[0];if(1===("c"===s?i.inputs[e].value:i.gates[s].outputs.find((function(t){return t.id===e})).value))return i.outputs[t].state=1,{v:void 0}};for(e.s();!(n=e.n()).done;){var s=u();if("object"===typeof s)return s.v}}catch(c){e.e(c)}finally{e.f()}this.outputs[t].state=0}}]),t}());x.addGate(O,100,100),x.addGate(j,300,100);var k=null,w={x:0,y:0};var I=function(){var t=u.a.useState(),n=Object(l.a)(t,2)[1],i=u.a.useCallback((function(){return n({})}),[]),e=function(t,n){x.addConnection(t,n),i()};return Object(h.jsx)("div",{className:"App",children:Object(h.jsxs)("div",{className:"circuit",onMouseUp:function(){k=null,i()},onMouseMove:function(t){k&&(w.x=t.clientX,w.y=t.clientY,i())},children:[Object(h.jsx)("div",{className:"curcuit-inputs",onClick:function(t){x.addInput(t.clientY-20),i()}}),Object(h.jsx)("div",{className:"curcuit-outputs",onClick:function(t){x.addOutput(t.clientY-20),i()}}),Object.values(x.inputs).map((function(t){return Object(h.jsx)(b,{input:t,connections:x.connections,onClick:function(n){if(n.ctrlKey)x.removeInput(t.id);else{t.toggle();var e,u=Object(r.a)(x.allOutcomingSignals(t.id));try{for(u.s();!(e=u.n()).done;){var s=e.value,c=s.split(":"),a=Object(l.a)(c,1)[0];x.gates[a]?x.updateGate(a):"c"===a&&x.updateOutput(s)}}catch(o){u.e(o)}finally{u.f()}}i()},onMouseDown:function(){k||(k=t.id)}},t.id)})),Object.values(x.outputs).map((function(t){return Object(h.jsx)(y,{output:t,connections:x.connections,onClick:function(n){n.ctrlKey&&x.removeOutput(t.id),i()},onMouseUp:function(){k&&e(k,t.id),k=null}},t.id)})),Object.values(x.gates).map((function(t){return Object(h.jsx)(g,{gate:t,connections:x.connections,onConnectionMade:e},t.id)})),Object(h.jsxs)("svg",{children:[Array.from(x.connections).map((function(t){var n=t.split("-"),i=Object(l.a)(n,2),e=i[0],u=i[1];return Object(h.jsx)(m,{complete:!0,start:e,end:u},t)})),k&&Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(m,{start:k})})]})]})})};c.a.render(Object(h.jsx)(u.a.StrictMode,{children:Object(h.jsx)(I,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.ee268330.chunk.js.map